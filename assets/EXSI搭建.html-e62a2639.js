import{_ as s}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as p,c as l,b as e,d as i,e as n,f as r}from"./app-2900c801.js";const c={},o=r('<h2 id="硬件环境" tabindex="-1"><a class="header-anchor" href="#硬件环境" aria-hidden="true">#</a> 硬件环境</h2><p>cpu：12 CPUs x 12th Gen Intel(R) Core(TM) i7-12700</p><p>网卡：Realtek R8168</p><p>主机安装暂时只碰到这两个硬件不兼容的问题。</p><h2 id="遇到问题" tabindex="-1"><a class="header-anchor" href="#遇到问题" aria-hidden="true">#</a> 遇到问题</h2><h6 id="无法识别网卡-已解决" tabindex="-1"><a class="header-anchor" href="#无法识别网卡-已解决" aria-hidden="true">#</a> <a href="#id1">无法识别网卡（已解决）</a></h6><p>报错内容如下图：</p><p><img src="https://s2.loli.net/2023/09/18/mPkyiQef26VsowD.png" alt="image-20230918091234660"></p><p>可能出现的原因</p>',9),d=e("li",null,[e("p",null,"没有接入网线")],-1),u=r('<p>没有相应的网卡驱动</p><p><a href="#url1">仅使用v6.7及以下版本，高版本禁用所有依赖Linux的驱动<sup>①</sup></a>。<strong>注：未找到官方文档证明</strong></p><ul><li><p>查看驱动型号，更改适配器选项-&gt;网卡属性-&gt;详细信息-&gt;硬件ID</p><p><img src="https://s2.loli.net/2023/09/18/cCiKW7JIu6mZhNB.png" alt="2023-09-18_17-46-00"></p></li><li><p>官网下载相应的VIB文件。</p><p>​ https://vibsdepot.v-front.de/wiki/index.php/List_of_currently_available_ESXi_packages</p><p>根据网卡信息Realtek 8168 选择驱动。</p><p><img src="https://s2.loli.net/2023/09/18/Gh4DbynAk3dvTVY.png" alt="2023-09-18_23-35-03"></p></li><li><p>下载ESXi-Customizer-PS工具</p><p>https://github.com/VFrontDe-Org/ESXi-Customizer-PS</p></li><li><p>Rufus制作启动盘</p><p>https://rufus.ie/zh/</p></li><li><p>安装新ISO</p></li></ul><p><a href="#url1">适用所有版本<sup>①</sup></a>。<strong>注：需要使用USB网卡</strong></p><p>已安装USB驱动的V8.0版本：https://pan.baidu.com/share/init?surl=2wopl2WO-H5dnnG-Xw6uXg&amp;pwd=52pj</p><ul><li><p>购买USB驱动网卡</p><p>USB网卡支持驱动ASIX88179, RTL8152/RTL8153, AQC111U等</p></li><li><p>下载相应USB驱动</p><p>https://flings.vmware.com/usb-network-native-driver-for-esxi</p></li><li><p>下载ESXi-Customizer-PS工具</p><p>https://github.com/VFrontDe-Org/ESXi-Customizer-PS</p></li><li><p>Rufus制作启动盘</p><p>https://rufus.ie/zh/</p></li><li><p>安装新ISO</p></li></ul><h6 id="网卡安装教程" tabindex="-1"><a class="header-anchor" href="#网卡安装教程" aria-hidden="true">#</a> 网卡安装教程：</h6>',7),h={href:"https://www.dinghui.org/vmware-powercli-esxi-customizer-ps.html",target:"_blank",rel:"noopener noreferrer"},m={href:"https://www.dinghui.org/esxi-customizer-ps.html",target:"_blank",rel:"noopener noreferrer"},g=r('<h6 id="cpu兼容问题-已解决" tabindex="-1"><a class="header-anchor" href="#cpu兼容问题-已解决" aria-hidden="true">#</a> <a href="#id2">CPU兼容问题（已解决）</a></h6><p>报错内容如下图：</p><p><img src="https://s2.loli.net/2023/09/18/thakUYROpBDImN6.png" alt="image-20230918091455714"></p><p>解决方法：</p><ul><li><p><a href="#url2">临时解决办法<sup>②</sup></a>：安装程序时或者开机时，在左下角倒计时结束前按Shift+O，输入<strong>cpuUniformityHardCheckPanic=FALSE</strong> 临时跳过cpu检测</p></li><li><p><a href="#url2">永久解决办法<sup>②</sup></a>：</p><p>未安装</p><ul><li><p>修改<strong>boot.cfg</strong>配置文件</p><ul><li>共两个<strong>BOOT.CFG</strong>，一个在ISO文件<strong>根</strong>目录，一个在**/EFI/BOOT/BOOT.CFG**</li></ul></li><li><p>修改内容</p><ul><li><p>在<strong>kernelopt</strong>后添加<strong>cpuUniformityHardCheckPanic=FALSE</strong>，记得空格隔开</p><p><img src="https://s2.loli.net/2023/09/18/g9HzaVlmRZF8bCG.png" alt="image-20230918111725818"></p></li></ul></li></ul><p>已安装</p><p>方法一:</p><ul><li>修改<strong>boot.cfg</strong>配置文件 <ul><li>同样共两个<strong>BOOT.CFG</strong>，位置似乎相同，使用ssh连接上exsi，使用命令<strong>find / -name boot.cfg</strong>搜索文件（注：EXSI默认是没有打开ssh的，需要手动开启）</li></ul></li><li>修改内容 <ul><li>与未安装的内容相同，按照未安装的内容修改。</li></ul></li></ul><p><a href="#url3">方法二<sup>③</sup></a>:</p><ul><li><p>使内核选项永久化，使用ssh连接exsi，执行下面命令</p><p><code>esxcli system settings kernel set -s cpuUniformityHardCheckPanic -v FALSE</code></p></li></ul></li></ul><h6 id="exsi-v6-7-及以下cpu兼容问题-未解决" tabindex="-1"><a class="header-anchor" href="#exsi-v6-7-及以下cpu兼容问题-未解决" aria-hidden="true">#</a> <a href="#id3">EXSI v6.7 及以下CPU兼容问题（未解决）</a></h6><p>报错内容如下图：</p><p><img src="https://s2.loli.net/2023/09/18/pmOEqS1a46olj8C.png" alt="image-20230918091943319"></p><p>使用cpu跳过检测之后安装依旧出现BSP报错，没找到什么有效办法解决。直接换高版本EXSI进行安装。</p><h6 id="紫屏其他原因" tabindex="-1"><a class="header-anchor" href="#紫屏其他原因" aria-hidden="true">#</a> 紫屏其他原因</h6>',10),b={href:"https://blog.51cto.com/huanwenli/2362353",target:"_blank",rel:"noopener noreferrer"},_=r(`<h2 id="安装流程" tabindex="-1"><a class="header-anchor" href="#安装流程" aria-hidden="true">#</a> 安装流程</h2><p>U盘启动就不描述了，百度很多，用Rufus或者Ventoy装机都可以。安装过程忘记截图了，借用别人的图。</p><p>U盘启动之后就会在左下角开始读秒，这时候就需要按<strong>Shift+O</strong>，输入<strong>cpuUniformityHardCheckPanic=FALSE</strong>跳过检测（如果修改过镜像文件，按<strong>Shift+O</strong>就会看到跳过检测的参数）。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/6c9d00c769716/6c9d00c769716.png" alt="image-2023_09_18"></p><p>输入完之后回车，开始读取镜像配置。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/129f413f20a70/129f413f20a70.png" alt="image-2023_09_18_52"></p><p>没有什么问题就会进入下面截图，回车继续，如果报错无法识别到网卡向上看解决操作。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/a082405a1b681/a082405a1b681.png" alt="image_2023_09_18_54"></p><p>按F11同意协议，这里少一张不重要的图。</p><p>​ 假装这是一张图</p><p>选择存储位置，按自己需求选择，回车确定选择。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/d92aa9ee5f0a6/d92aa9ee5f0a6.png" alt="image_2023_09_18_56"></p><p>选择键盘布局，没有特殊需求的，就直接回车确定。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/b59d68a8aa1e8/b59d68a8aa1e8.png" alt="image_2023_09_18_00"></p><p>设置密码，复杂度要求有数字、字母、特殊符号，设置完成就回车。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/092f99991f689/092f99991f689.png" alt="image_2023_09_18_02"></p><p>确认无误，就继续确定</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/e9b7eeb6c0d83/e9b7eeb6c0d83.png" alt="image_2023_09_18_06"></p><p>硬盘初始化，开始安装按F11，不是按回车了。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/7fc91d1f994dd/7fc91d1f994dd.png" alt="image_2023_09_18_07"></p><p>开始安装</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/149d4e1bbce3c/149d4e1bbce3c.png" alt="image_2023_09_18_09"></p><p>使用usb网卡，这里可能会出现，在安装到73%或者80%卡住的情况，左上角会出现两行英文，缺失截图。拔掉U盘重启就会进入ESXI系统。root密码是空的，记得修改密码。</p><p>正常安装结束。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/fe456524a646d/fe456524a646d.png" alt="image_2023_09_18_17"></p><p>配置网络，进入系统之后按F2进入配置，如果非正常结束安装这里是没有IP地址的。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/d92aaa15fdb4c/d92aaa15fdb4c.png" alt="image_2023_09_18_22"></p><p>非正常安装，执行 <code>Network Restore Options</code>，保存退出，回到主界面此时网卡能正确获取 DHCP 分配的 IP 地址。这是一个示意图。根据需求对IP进行调整。</p><p><img src="https://image.abcdocker.com/abcdocker/2022/10/25/d10ce8281cafa/d10ce8281cafa.png" alt="image_2023_09_18_26"></p><p>非正常安装重启之后，USB网卡就会识别不到，需要重新配置。需要登录上web管理界面，打开ESXI的ssh连接。</p><p>编辑 <code>/etc/rc.local.d/local.sh</code> 文件：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># Note:...

# 添加下面的代码
vusb0_status=$(esxcli network nic get -n vusb0 |grep &#39;Link Status&#39; | awk &#39;{print $NF}&#39;)
count=0
while [[ $count -lt 20 &amp;&amp; &quot;\${vusb0_status}&quot; != &quot;Up&quot; ]]
do
        sleep 10
        count=$(( $count + 1 ))
        vusb0_status=$(esxcli network nic get -n vusb0 |grep &#39;Link Status&#39; | awk &#39;{print $NF}&#39;)
done

esxcfg-vswitch -R
#添加的代码结束

exit 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>保存，开机自动使用USB网卡作为ESXI的管理端口。</p><p>至此安装完成。</p><h2 id="附8-0密钥" tabindex="-1"><a class="header-anchor" href="#附8-0密钥" aria-hidden="true">#</a> 附8.0密钥</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>esxi8.0测试密钥

VMware vSphere ESXi 8.0
ESXi 8：4V492-44210-48830-931GK-2PRJ4
VCSA 8：0Z20K-07JEH-08030-908EP-1CUK4
ESXi 8：4F40H-4ML1K-M89U0-0C2N4-1AKL4
VCSA 8：0F41K-0MJ4H-M88U1-0C3N0-0A214

ESXi 8：HG00K-03H8K-48929-8K1NP-3LUJ4
VCSA 8：4F282-0MLD2-M8869-T89G0-CF240
vSAN 8：NF212-08H0K-488X8-WV9X6-1F024
vSAN 8：witness JF61H-48K8K-488X9-W98Z0-1FH24
Horizon Enterprise v8.x 0G4DA-49J81-M80R1-012N4-86KH4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="参考文档" tabindex="-1"><a class="header-anchor" href="#参考文档" aria-hidden="true">#</a> 参考文档</h3>`,37),v={id:"url1"},f={href:"https://dev.moe/2794",target:"_blank",rel:"noopener noreferrer"},S={id:"url2"},k={href:"https://tieba.baidu.com/p/8215985949",target:"_blank",rel:"noopener noreferrer"},x=e("p",null,[e("a",{id:"url3"},"Intel 1240安装ESXI文档 - LILEI-2 - 博客园](https://www.cnblogs.com/LILEIYAO/p/17096126.html)（参考内容：内核持久化）")],-1),E={href:"https://sysin.org/blog/vmware-esxi-8-u1-sysin/",target:"_blank",rel:"noopener noreferrer"},w={href:"https://frps.cn/321.html",target:"_blank",rel:"noopener noreferrer"},C={href:"https://www.chemex-demo.celaraze.com/2023/05/03/enable-usb-network-card-with-esxi-8-0/",target:"_blank",rel:"noopener noreferrer"},I={href:"https://www.cnblogs.com/niway/p/17149246.html",target:"_blank",rel:"noopener noreferrer"};function X(U,F){const a=t("ExternalLinkIcon");return p(),l("div",null,[o,e("ul",null,[d,e("li",null,[u,e("ol",null,[e("li",null,[e("a",h,[i("使用ESXi-Customizer-PS为ESXi 8.0封装第三方驱动 – 丁辉博客"),n(a)])]),e("li",null,[e("a",m,[i("使用ESXi-Customizer-PS为ESXi封装第三方驱动 – 丁辉博客"),n(a)])])])])]),g,e("p",null,[e("a",b,[i("ESXI主机紫屏分析方法_51CTO博客_esxi紫屏"),n(a)])]),_,e("p",null,[e("a",v,[i("①"),e("a",f,[i("ESXi 7.0 + R8168 / R8169 安装笔记 - Coxxs"),n(a)]),i("（参考内容：EXSI不在支持Realtek R8168网卡，USB网卡支持驱动ASIX88179, RTL8152/RTL8153, AQC111U）")])]),e("p",null,[e("a",S,[e("a",k,[i("②12代酷睿安装ESXI 紫屏幕报错的解决方法【软路由吧】_百度贴吧"),n(a)]),i("（参考内容： 临时跳过CPU一致性，永久性跳过方法）")])]),x,e("p",null,[e("a",E,[i(" VMware ESXi 8.0U1c macOS Unlocker & OEM BIOS 集成网卡驱动和 NVMe 驱动 (集成驱动版) - sysin | SYStem INside | 软件与技术分享 "),n(a)]),i("（参考内容：USB驱动的V8.0版本）")]),e("p",null,[e("a",w,[i("VMware Workstation虚拟机安装VMware vSphere 8.0(esxi) – Frps.cn 中文文档"),n(a)]),i("（参考内容：所有的图片出处）")]),e("p",null,[e("a",C,[i("ESXi8 中使用 USB 网卡作为管理端口并开机自启动 - Celaraze Blog"),n(a)]),i("（参考内容：USB网卡自动设置）")]),e("p",null,[e("a",I,[i("esxi8.0测试密钥 - 昵称昵称昵称 - 博客园"),n(a)]),i("（参考内容：测试密钥）")])])}const P=s(c,[["render",X],["__file","EXSI搭建.html.vue"]]);export{P as default};
